<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>De-TECH</title>
    <link rel="icon" href="../static/images/favicon16.png" sizes="16x16" type="image/png">
    <link rel="icon" href="../static/images/favicon32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="../static/images/favicon192.png" sizes="192x192" type="image/png">
    <link rel="icon" href="../static/images/favicon512.png" sizes="512x512" type="image/png">
    <link rel="apple-touch-icon" href="../static/images/faviconapple.png" sizes="180x180">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="../static/content/style3a.css">
    <script src="../static/scripts/jquery-1.10.2.js"></script>

     <!-- APPLY ALL PAGE START -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- APPLY ALL PAGE END -->
</head>

<body>

  <!-- PARENT WRAPPER -->
  <div class="wrapper-card">

      <!-- HEADER -->
      <div class="row wrapper-header">
            <div class="col-sm-5 col-12"  style="text-align: left; margin-top: -10px;">
              <span class="logo-container">
                    <img src="../static/images/logodt.png" alt="Logo" width="70" height="70">
                    <span class="logo-description">De - TECH</span>
                </span>
            </div>

            <div class="col-sm-4 col-12" style="text-align: left">
                <h1 class="sis">
                    ANALYSIS
                </h1>
            </div>

            <div class="col-sm-3 col-12" style="text-align: right">
				<a href="/home"><i class='bx bxs-home-alt-2'></i></a>
            </div>
        </div>
        <!-- HEADER END -->

        <!-- CONTENT -->
        <div class="row">
            <div class="col-sm-6 col-12">
            	<table class="table">
            	    <tr>
            			<td class="td2">Start Time:</td>
            		</tr>
            		<tr>
            			<td class="td1" id="analysisstarttime"></td>
            		</tr>
            		<tr>
            			<td class="td2">Duration:</td>
            		</tr>
            		<tr>
            			<td class="td1" id="analysisdur"></td>
            		</tr>
            		<tr>
            			<td class="td2">Protocol:</td>
            		</tr>
            		<tr>
            			<td class="td1" id="analysisprotocol"></td>
            		</tr>
            		<tr>
            			<td class="td2">Source IP Address:</td>
            		</tr>
            		<tr>
            			<td class="td1" id="analysissourceip"></td>
            		</tr>
            		<tr>
            			<td class="td2">Destination IP Address:</td>
            		</tr>
            		<tr>
            			<td class="td1" id="analysisdestip"></td>
            		</tr>
            		<tr>
            			<td class="td2">Destination Port:</td>
            		</tr>
            		<tr>
            			<td class="td1" id="analysisdestport"></td>
            	</table>

                <div class="col-12" style="text-align: center">
                    <a class="h3" href="/detect">Go Back to Detect Page</a>
                </div>
            </div>

            <div class="col-sm-6 col-12 container">
                <div class="h4">
                    <p>Traffic:</p>
                </div>
                <div class="container2" id="analysistraffic"></div>
                <div class="h5">
                    <p>Classification:</p>
                </div>
                <div class="container1" style="text-align: center;">
                    <table class="table3" id="table3">
                        <tr>
                            <td class="td3" id="analysisclassify"></td>
                        </tr>
                    </table>
                    <a class="h6" id="toggleLink">View Traffic Classification Summary</a>
                </div>
                <div class="col-12" style="text-align: right;margin-top: 0px;">
                    <a class="h2" href="/dashboard">See the Dashboard Results!</a>
                </div>
            </div>

                <!-- MODAL -->
            <div class="modal" id="termsModal">
              <div class="modal-content">
                <span class="close">&times;</span>
                <table class="table4" id="table4">
                  <tr>
                    <td class="td6">NORMAL</td>
                  </tr>
                  <tr>
                    <td class="td5" id="analysisnormal"></td>
                  </tr>
                  <tr>
                    <td class="td6">BOTNET</td>
                  </tr>
                  <tr>
                    <td class="td5" id="analysisbotnet"></td>
                  </tr>
                  <tr>
                    <td class="td6">BRUTEFORCE</td>
                  </tr>
                  <tr>
                    <td class="td5" id="analysisbrutef"></td>
                  </tr>
                  <tr>
                    <td class="td6">DENIAL OF SERVICE (DoS)</td>
                  </tr>
                  <tr>
                    <td class="td5" id="analysisdos"></td>
                  </tr>
                  <tr>
                    <td class="td6">INFILTRATION</td>
                  </tr>
                  <tr>
                    <td class="td5" id="analysisinf"></td>
                  </tr>
                </table>
              </div>
            </div>
        </div>
    </div>

</body>
</html>


<script>
    // Check if an alert message is provided and display it
    const userLoggedIn = "{{ userLoggedIn }}"; // Injected from Flask
    const userIdLoggedIn = "{{ userIdLoggedIn }}"; // Injected from Flask
    const recordExists = "{{ recordExists }}";


    if (recordExists == "1") {
        $("#analysisstarttime").html("{{ starttime }}");
        $("#analysisdur").html("{{ dur }}");
        $("#analysisprotocol").html("{{ protocol }}");
        $("#analysissourceip").html("{{ sourceip }}");
        $("#analysisdestip").html("{{ destip }}");
        $("#analysisdestport").html("{{ destport }}");
        $("#analysistraffic").html("{{ traffic }}");
        $("#analysisnormal").html("{{ normal }}");
        $("#analysisbrutef").html("{{ brutef }}");
        $("#analysisbotnet").html("{{ botnet }}");
        $("#analysisdos").html("{{ dos }}");
        $("#analysisinf").html("{{ inf }}");
        $("#analysisclassify").html("{{ classify }}");
    }

    // Get the modal
    var modal = document.getElementById("termsModal");

    // Get the link that opens the modal
    var link = document.getElementById("toggleLink");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks the link, open the modal
    link.onclick = function() {
      modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }
</script>